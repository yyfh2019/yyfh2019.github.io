<!-- index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>短网址生成器</title>
    <script>
        // 本地存储模拟数据库（仅当前浏览器有效）
        const db = JSON.parse(localStorage.getItem('shortUrls') || '{}')
        
        // 生成随机6位字符
        function generateCode() {
            return Math.random().toString(36).substr(2, 6)
        }

        // 生成短网址
        function createShortUrl(longUrl) {
            let code
            do {
                code = generateCode()
            } while (db[code])
            
            db[code] = longUrl
            localStorage.setItem('shortUrls', JSON.stringify(db))
            return location.href + code
        }

        // 表单提交处理
        function handleSubmit(e) {
            e.preventDefault()
            const longUrl = document.getElementById('longUrl').value
            const shortUrl = createShortUrl(longUrl)
            document.getElementById('result').innerHTML = `
                短网址生成成功：<a href="${shortUrl}">${shortUrl}</a>
            `
        }

        // 页面加载时检查短码
        function checkRedirect() {
            const path = location.pathname.substr(1)
            if (path && db[path]) {
                location.href = db[path]
            }
        }
    </script>
</head>
<body onload="checkRedirect()">
    <h1>短网址生成器</h1>
    <form onsubmit="handleSubmit(event)">
        <input type="url" id="longUrl" required placeholder="输入长网址">
        <button type="submit">生成短网址</button>
    </form>
    <div id="result"></div>
</body>
</html>
